<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>American Roulette</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="Lab_2_files/libs/clipboard/clipboard.min.js"></script>
<script src="Lab_2_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="Lab_2_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="Lab_2_files/libs/quarto-html/popper.min.js"></script>
<script src="Lab_2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Lab_2_files/libs/quarto-html/anchor.min.js"></script>
<link href="Lab_2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Lab_2_files/libs/quarto-html/quarto-syntax-highlighting-de070a7b0ab54f8780927367ac907214.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Lab_2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Lab_2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Lab_2_files/libs/bootstrap/bootstrap-81267100e462c21b3d6c0d5bf76a3417.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">American Roulette</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell" data-context="setup">
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   4.0.0     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors

Attaching package: 'plotly'


The following object is masked from 'package:ggplot2':

    last_plot


The following object is masked from 'package:stats':

    filter


The following object is masked from 'package:graphics':

    layout


── Attaching packages ────────────────────────────────────── tidymodels 1.2.0 ──

✔ broom        1.0.6     ✔ rsample      1.2.1
✔ dials        1.3.0     ✔ tune         1.2.1
✔ infer        1.0.7     ✔ workflows    1.1.4
✔ modeldata    1.4.0     ✔ workflowsets 1.1.0
✔ parsnip      1.2.1     ✔ yardstick    1.3.1
✔ recipes      1.1.0     

── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──
✖ scales::discard() masks purrr::discard()
✖ plotly::filter()  masks dplyr::filter(), stats::filter()
✖ recipes::fixed()  masks stringr::fixed()
✖ dplyr::lag()      masks stats::lag()
✖ infer::observe()  masks shiny::observe()
✖ yardstick::spec() masks readr::spec()
✖ recipes::step()   masks stats::step()
• Search for functions across packages at https://www.tidymodels.org/find/</code></pre>
</div>
</div>
<section id="section" class="level1 sidebar" width="35%">
<h1 class="sidebar" width="35%"></h1>
<div class="cell" title="Student Seed">
<div class="cell-output-display">
<div class="form-group shiny-input-container">
<label class="control-label" id="seed-label" for="seed">Random Seed:</label>
<input id="seed" type="number" class="shiny-input-number form-control" value="1234" data-update-on="change" min="0" max="9999" step="1">
</div>
</div>
</div>
<section id="overview" class="level3">
<h3 class="anchored" data-anchor-id="overview">Overview</h3>
<p>This Lab revolves around simulating spins from a roulette wheel. You will compare different bets and their convergence to their expected profits, as well as compare frequencies between a biased and unbiased wheel. There will also be some brief discussion of Chebyshev’s Theorem (equations provided). For additional help, refer to Chapter 3 of the textbook. Answer the questions using the corresponding Canvas quiz.</p>
</section>
<section id="set-seed" class="level3">
<h3 class="anchored" data-anchor-id="set-seed">Set Seed</h3>
<p>Please set the random seed to the last 4 digits of your Student ID (if using your ID card, your Student ID is the number between the 2 dashes).</p>
</section>
<section id="part-i-comparing-betting-strategies" class="level3">
<h3 class="anchored" data-anchor-id="part-i-comparing-betting-strategies">Part I: Comparing Betting Strategies</h3>
<p>For this lab, we will focus on four different kinds of bets: Straight up bets, split bets, red or black, and first to third dozen. The payouts are 35:1, 17:1, 1:1, and 2:1. They are set in such a way that the expected profit for each bet is -2/38 for a $1 bet. Out of 38 pockets, the number of pockets that correspond to each bet are 1, 2, 18, and 12.</p>
<ol type="1">
<li><p>Calculate the variance for each bet if the betting amount is $1.</p></li>
<li><p>Set the betting amounts to $1. Focus on the first plot, which shows the running average profit as more spins are generated. Compare this to the dotted line, which is the expected profit each running average should converge to. Are there any bets that take longer to converge than others? Is there a relationship between the variance of a bet and how long it takes to converge?</p></li>
<li><p>Now, adjust the bets so you bet $3 on red and $2 on the 2nd dozen, and the remaining bets are 0. The running average of the combined bet is shown in the second plot. Adjust the plot so only the dozen and color bet are shown. Fill out the table on the Canvas quiz and use it to calculate the mean and variance.</p></li>
</ol>
<div class="cell">
<div class="cell-output-display no-overflow-x">
<div id="combined.bet" class="shiny-html-output shiny-table-output"></div>
</div>
</div>
<ol start="4" type="1">
<li>How does the variance of this combined bet compare to the individual variances of the betting on red and the 2nd dozen? Does the behavior between these two plots agree with this relationship?</li>
</ol>
<p>The mean of this combined bet can also be calculated separately:</p>
<p>X = profit from red/black bet</p>
<p>Y = profit from dozen bet</p>
<p><span class="math display">\[
\begin{aligned}
\mathbb{E}[3X + 2Y] &amp;=
5\mathbb{E}[X] + 2\mathbb{E}[Y]  \\
&amp;\approx 3(-0.0526) + 2(-0.0526) \\
&amp;\approx -0.263
\end{aligned}
\]</span></p>
<p>This equation can make calculations easier, and works regardless if X and Y are independent or not. However, the same is not typically true for vairance. The following equation for variance:</p>
<p><span class="math display">\[
\begin{aligned}
Var[3X + 2Y] &amp;=
3^2Var[X] + 2^2Var[Y]
\end{aligned}
\]</span></p>
<p><strong><em>ONLY APPLIES</em></strong> when X and Y are <em>independent</em>.</p>
<ol start="5" type="1">
<li>What are the pros and cons of combining bets (Graded on effort. No wrong answers. If you are having trouble, compare the mean and variance between the combined bets and individual bets).</li>
</ol>
</section>
<section id="part-ii-bias-detection" class="level3">
<h3 class="anchored" data-anchor-id="part-ii-bias-detection">Part II: Bias Detection</h3>
<p>Switch the panel to “Bias Detection.” For this section, you will adjust the bias of pockets 2,4, and 21, as well as how many spins are performed. The left plot displays the frequency of each pocket when there is a bias, while the right plot corresponds to an even wheel. Make sure the bias is set to 0.033 and the number of spins to 10,000.</p>
<ol start="6" type="1">
<li><p>If you did not know beforehand that 2,4, and 21 were biased, would you be able to distinguish the biased wheel from the unbiased one based on these frequencies?</p></li>
<li><p>Increase the number of spins until the p-value is 10,000. A p-value less than 0.05 would indicate a significant difference between the biased and unbiased wheel frequencies. Does it ever reach significance?</p></li>
<li><p>Keep the number of spins at 10,000 and increase the bias until the p-value is less than 0.05. Based on the biased wheel graph, would you be able to tell that pockets 2,4,21 are biased? (Graded on effort. No wrong answers.)</p></li>
</ol>
</section>
</section>
<section id="comparing-betting-strategies" class="level1">
<h1>Comparing Betting Strategies</h1>
<section id="bets" class="level2" height="30%">
<h2 height="30%" class="anchored" data-anchor-id="bets">Bets</h2>
<section id="straight" class="level3">
<h3 class="anchored" data-anchor-id="straight">Straight</h3>
<div class="cell" title="Straight Up">
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label shiny-label-null" for="straight_choice" id="straight_choice-label"></label>
<div>
<select id="straight_choice" class="shiny-input-select"><option value="00" selected="">00</option>
<option value="0">0</option>
<option value="1">1</option>
<option value="2">2</option>
<option value="3">3</option>
<option value="4">4</option>
<option value="5">5</option>
<option value="6">6</option>
<option value="7">7</option>
<option value="8">8</option>
<option value="9">9</option>
<option value="10">10</option>
<option value="11">11</option>
<option value="12">12</option>
<option value="13">13</option>
<option value="14">14</option>
<option value="15">15</option>
<option value="16">16</option>
<option value="17">17</option>
<option value="18">18</option>
<option value="19">19</option>
<option value="20">20</option>
<option value="21">21</option>
<option value="22">22</option>
<option value="23">23</option>
<option value="24">24</option>
<option value="25">25</option>
<option value="26">26</option>
<option value="27">27</option>
<option value="28">28</option>
<option value="29">29</option>
<option value="30">30</option>
<option value="31">31</option>
<option value="32">32</option>
<option value="33">33</option>
<option value="34">34</option>
<option value="35">35</option>
<option value="36">36</option></select>
<script type="application/json" data-for="straight_choice" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display">
<div class="form-group shiny-input-container" style="width:100%;">
<label class="control-label shiny-label-null" for="straight_amount" id="straight_amount-label"></label>
<input id="straight_amount" type="number" class="shiny-input-number form-control" value="0" data-update-on="change" min="0">
</div>
</div>
</div>
</section>
<section id="split" class="level3">
<h3 class="anchored" data-anchor-id="split">Split</h3>
<div class="cell" title="Split">
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label shiny-label-null" for="split_choice" id="split_choice-label"></label>
<div>
<select id="split_choice" class="shiny-input-select"><option value="1-2" selected="">1-2</option>
<option value="2-3">2-3</option>
<option value="4-5">4-5</option>
<option value="5-6">5-6</option>
<option value="7-8">7-8</option>
<option value="8-9">8-9</option>
<option value="10-11">10-11</option>
<option value="11-12">11-12</option></select>
<script type="application/json" data-for="split_choice" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display">
<div class="form-group shiny-input-container" style="width:100%;">
<label class="control-label shiny-label-null" for="split_amount" id="split_amount-label"></label>
<input id="split_amount" type="number" class="shiny-input-number form-control" value="0" data-update-on="change" min="0">
</div>
</div>
</div>
</section>
<section id="color" class="level3">
<h3 class="anchored" data-anchor-id="color">Color</h3>
<div class="cell" title="Color">
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label shiny-label-null" for="color_choice" id="color_choice-label"></label>
<div>
<select id="color_choice" class="shiny-input-select"><option value="Red" selected="">Red</option>
<option value="Black">Black</option></select>
<script type="application/json" data-for="color_choice" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display">
<div class="form-group shiny-input-container" style="width:100%;">
<label class="control-label shiny-label-null" for="color_amount" id="color_amount-label"></label>
<input id="color_amount" type="number" class="shiny-input-number form-control" value="0" data-update-on="change" min="0">
</div>
</div>
</div>
</section>
<section id="dozen" class="level3">
<h3 class="anchored" data-anchor-id="dozen">Dozen</h3>
<div class="cell" title="Dozen">
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label shiny-label-null" for="dozen_choice" id="dozen_choice-label"></label>
<div>
<select id="dozen_choice" class="shiny-input-select"><option value="1st" selected="">1st</option>
<option value="2nd">2nd</option>
<option value="3rd">3rd</option></select>
<script type="application/json" data-for="dozen_choice" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display">
<div class="form-group shiny-input-container" style="width:100%;">
<label class="control-label shiny-label-null" for="dozen_amount" id="dozen_amount-label"></label>
<input id="dozen_amount" type="number" class="shiny-input-number form-control" value="0" data-update-on="change" min="0">
</div>
</div>
</div>
</section>
</section>
<section id="plots" class="level2">
<h2 class="anchored" data-anchor-id="plots">Plots</h2>
<div class="cell" title="Individual Bets">
<div class="cell-output-display">
<div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item" id="individualPlot" style="width:100%;height:400px;"></div>
</div>
</div>
<div class="cell" title="Combined Bet">
<div class="cell-output-display">
<div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item" id="combinedPlot" style="width:100%;height:400px;"></div>
</div>
</div>
</section>
</section>
<section id="bias-detection" class="level1">
<h1>Bias Detection</h1>
<section id="controls" class="level2" height="25%">
<h2 height="25%" class="anchored" data-anchor-id="controls">Controls</h2>
<div class="cell">
<div class="cell-output-display">
<div class="form-group shiny-input-container">
<label class="control-label" id="bias_level-label" for="bias_level">Bias Level:</label>
<input id="bias_level" type="number" class="shiny-input-number form-control" value="0.026" data-update-on="change" min="0" max="0.1" step="0.001">
</div>
</div>
<div class="cell-output-display">
<div class="form-group shiny-input-container">
<label class="control-label" id="bias_n-label" for="bias_n">Number of Spins:</label>
<input id="bias_n" type="number" class="shiny-input-number form-control" value="1000" data-update-on="change" min="1000" max="10000" step="1000">
</div>
</div>
</div>
</section>
<section id="plots-1" class="level2">
<h2 class="anchored" data-anchor-id="plots-1">Plots</h2>
<section id="biased-wheel" class="level3">
<h3 class="anchored" data-anchor-id="biased-wheel">Biased Wheel</h3>
<div class="cell">
<div class="cell-output-display">
<div class="shiny-plot-output html-fill-item" id="biasPlot" style="width:100%;height:400px;"></div>
</div>
</div>
</section>
<section id="unbiased-wheel" class="level3">
<h3 class="anchored" data-anchor-id="unbiased-wheel">Unbiased Wheel</h3>
<div class="cell">
<div class="cell-output-display">
<div class="shiny-plot-output html-fill-item" id="unbiasPlot" style="width:100%;height:400px;"></div>
</div>
</div>
</section>
</section>
<section id="chi-squared-table" class="level2">
<h2 class="anchored" data-anchor-id="chi-squared-table">Chi-Squared Table</h2>
<div class="cell">
<div class="cell-output-display no-overflow-x">
<div id="significantTable" class="shiny-html-output shiny-table-output"></div>
</div>
</div>
<p>
<script type="application/shiny-prerendered" data-context="server-start">
library(tidyverse)
library(plotly)
library(tidymodels)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
# bets
simulate_roulette <- function(bets, amounts, seed, n_spins = 30000) {
  
  set.seed(seed)
  wheel <- c("00", "0", as.character(1:36))
  spins <- sample(wheel, n_spins, replace = TRUE)
  
  reds <- c("1","3","5","7","9","12","14","16","18","19","21","23","25","27","30","32","34","36")
  blacks <- c("2","4","6","8","10","11","13","15","17","20","22","24","26","28","29","31","33","35")
  
  split.bets = list('1-2' = wheel[3:4], '2-3' = wheel[4:5], '4-5' = wheel[6:7], 
                    '5-6' = wheel[7:8], '7-8' = wheel[9:10], '8-9' = wheel[10:11], 
                    '10-11' = wheel[12:13], '11-12' = wheel[13:14])
  color.bets = list('Red' = reds, 'Black' = blacks)
  dozen.bets = list('1st' = wheel[1:12], '2nd' = wheel[13:24], 
                    '3rd' = wheel[25:36])
  
  ifelse(spins == bets[1], 35*amounts[1], -amounts[1]) -> running.straight
  ifelse(spins %in% split.bets[[bets[2]]], 17*amounts[2], -amounts[2]) -> running.split
  ifelse(spins %in% color.bets[[bets[3]]], amounts[3], -amounts[3]) -> running.color
  ifelse(spins %in% dozen.bets[[bets[4]]], 2*amounts[4], -amounts[4]) -> running.dozen
  
  running.total = running.straight + running.split + running.color + running.dozen
  
  data.frame(
    Spin = 1:n_spins, 
    Straight = running.straight %>% cummean(),
    Split = running.split %>% cummean(),
    Total = running.total %>% cummean(),
    Color = running.color %>% cummean(),
    Dozen = running.dozen %>% cummean()
  )
}

sim_data <- reactive({
    bets <- c(input$straight_choice, input$split_choice,
              input$color_choice, input$dozen_choice)
    amounts = c(input$straight_amount, input$split_amount,
                input$color_amount, input$dozen_amount)
    simulate_roulette(bets, amounts, input$seed)
  })

output$individualPlot <- renderPlotly({
    req(sim_data())
    df <- sim_data() %>% select(-Total)
    df_long <- tidyr::pivot_longer(df, -Spin, names_to = "Bet", values_to = "AvgProfit")

    p <- ggplot(df_long, aes(x = Spin, y = AvgProfit, color = Bet)) +
        geom_line() +
        geom_hline(linetype='dashed', yintercept = -2/38 * c(input$straight_amount, input$split_amount, input$color_amount, input$dozen_amount)) + 
        labs(x = "Number of Spins", y = "Running Average Profit", color = "Bet") +
        theme_minimal(base_size = 14)

    ggplotly(p)
})
  
output$combinedPlot <- renderPlotly({
    req(sim_data())
    df <- sim_data()
    combined.exp = sum(-2/38 * c(input$straight_amount, input$split_amount, input$color_amount, input$dozen_amount))
    p <- ggplot(df, aes(x = Spin, y = Total)) +
        geom_line(color = "#E74C3C") +
        geom_hline(yintercept=combined.exp, linetype='dashed') +
        labs(x = "Number of Spins", y = "Running Average Combined Profit") +
        theme_minimal(base_size = 14)

    ggplotly(p)
})

# biased vs unbiased wheel
bias_data <- reactive({
    number <- as.character(0:37)
    number[38] <- '00'
    
    bias <- input$bias_level
    n <- input$bias_n
    
    biased.probs <- rep((1 - bias) / 35, 38)
    biased.probs[c(3, 5, 22)] <- rep(bias, 3)
    
    set.seed(NULL)
    unbiased <- sample(x = number, size = n, replace = TRUE)
    
    set.seed(input$seed)
    biased <- sample(x = number, size = n, prob = biased.probs, replace = TRUE)
    
    data.frame(
      biased.value = factor(biased, levels = number),
      unbiased.value = factor(unbiased, levels = number)
    )
  })

output$biasPlot = renderPlot({
    req(bias_data())
    df = bias_data() 
    df %>% 
      ggplot(aes(y=biased.value)) +
      geom_bar(fill='#db4d37')
  })
  
output$unbiasPlot = renderPlot({
    req(bias_data())
    df = bias_data() 
    df %>% 
        ggplot(aes(y=unbiased.value)) +
        geom_bar(fill='#2a7fbf')
})

output$significantTable = renderTable({
    req(bias_data())
    df = bias_data() 
        # summarise(.by = biased.value, n())
    table(df$biased.value) |> chisq.test() |> tidy()
})

# table for instructions
output$combined.bet = renderTable({
    data.frame(
        Outcome=c('Red in second dozen', 'Black in second dozen', 'Red not in second dozen', 'Rest'),
        Prob=rep('-',4),
        Profit=rep('-',4)
    )
})
</script>
 
<script type="application/shiny-prerendered" data-context="server-extras">
ojs_define <- function(..., .session = shiny::getDefaultReactiveDomain()) {
  quos <- rlang::enquos(...)
  vars <- rlang::list2(...)
  nm <- names(vars)
  if (is.null(nm)) {
    nm <- rep_len("", length(vars))
  }
  mapply(
    function(q, nm, val) {
      # Infer name, if possible
      if (nm == "") {
        tryCatch(
          {
            nm <- rlang::as_name(q)
          },
          error = function(e) {
            code <- paste(collapse = "\n", deparse(rlang::f_rhs(q)))
            stop(
              "ojs_define() could not create a name for the argument: ",
              code
            )
          }
        )
      }
      .session$output[[nm]] <- val
      outputOptions(.session$output, nm, suspendWhenHidden = FALSE)
      .session$sendCustomMessage("ojs-export", list(name = nm))
      NULL
    },
    quos,
    nm,
    vars,
    SIMPLIFY = FALSE,
    USE.NAMES = FALSE
  )
  invisible()
}
</script>
</p>
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.11.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.11.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.11.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.11.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.11.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.11.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.11.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.11.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111]}},"value":[{"type":"character","attributes":{},"value":["backports","base","broom","bslib","cachem","class","cli","codetools","compiler","data.table","datasets","dials","DiceDesign","digest","dplyr","evaluate","fansi","farver","fastmap","forcats","foreach","furrr","future","future.apply","generics","ggplot2","globals","glue","gower","GPfit","graphics","grDevices","grid","gtable","hardhat","hms","htmltools","htmlwidgets","httpuv","httr","infer","ipred","iterators","jquerylib","jsonlite","knitr","later","lattice","lava","lazyeval","lhs","lifecycle","listenv","lubridate","magrittr","MASS","Matrix","memoise","methods","mime","modeldata","nnet","parallel","parallelly","parsnip","pillar","pkgconfig","plotly","prodlim","promises","purrr","R6","RColorBrewer","Rcpp","readr","recipes","rlang","rmarkdown","rpart","rsample","rstudioapi","S7","sass","scales","shiny","splines","stats","stringi","stringr","survival","tibble","tidymodels","tidyr","tidyselect","tidyverse","timechange","timeDate","tools","tune","tzdb","utf8","utils","vctrs","viridisLite","withr","workflows","workflowsets","xfun","xtable","yaml","yardstick"]},{"type":"character","attributes":{},"value":["1.5.0","4.4.1","1.0.6","0.9.0","1.1.0","7.3-22","3.6.3","0.2-20","4.4.1","1.17.8","4.4.1","1.3.0","1.10","0.6.37","1.1.4","1.0.3","1.0.6","2.1.2","1.2.0","1.0.0","1.5.2","0.3.1","1.34.0","1.11.3","0.1.3","4.0.0","0.16.3","1.8.0","1.0.1","1.0-8","4.4.1","4.4.1","4.4.1","0.3.6","1.4.0","1.1.3","0.5.8.1","1.6.4","1.6.15","1.4.7","1.0.7","0.9-15","1.0.14","0.1.4","1.8.9","1.48","1.3.2","0.22-6","1.8.0","0.2.2","1.2.0","1.0.4","0.9.1","1.9.3","2.0.3","7.3-60.2","1.7-0","2.0.1","4.4.1","0.12","1.4.0","7.3-19","4.4.1","1.39.0","1.2.1","1.9.0","2.0.3","4.11.0","2024.06.25","1.3.3","1.0.2","2.5.1","1.1-3","1.1.0","2.1.5","1.1.0","1.1.4","2.28","4.1.23","1.2.1","0.16.0","0.2.0","0.4.9","1.4.0","1.11.1","4.4.1","4.4.1","1.8.4","1.5.1","3.6-4","3.2.1","1.2.0","1.3.1","1.2.1","2.0.0","0.3.0","4041.110","4.4.1","1.2.1","0.4.0","1.2.4","4.4.1","0.6.5","0.4.2","3.0.2","1.1.4","1.1.0","0.53","1.8-4","2.3.10","1.3.1"]}]}]}
</script>
<!--/html_preserve-->
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>